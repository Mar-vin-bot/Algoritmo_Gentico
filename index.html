<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
        * {
            background-color: black;
        }
    </style>
    <script>
        const prof_disc = [

            "Clarimundo-POO1",
            "Clarimundo-POO1",
            "Clarimundo-POO1",
            "Clarimundo-POO1",
            "Wilton-WebDesing",
            "Wilton-WebDesing",
            "Wilton-WebDesing",
            "Wilton-WebDesing",
            "Bruno-Requisitos",
            "Bruno-Requisitos",
            "Bruno-Requisitos",
            "Bruno-Requisitos",
            "Cricia-BDA",
            "Cricia-BDA",
            "Cricia-BDA",
            "Cricia-BDA",
            "Nelio-Logica",
            "Nelio-Logica",
            "Nelio-Logica",
            "Nelio-Logica",
            "Clarimundo-POO2",
            "Clarimundo-POO2",
            "Clarimundo-POO2",
            "Clarimundo-POO2",
            "Wilton-JavaScript",
            "Wilton-JavaScript",
            "Wilton-JavaScript",
            "Wilton-JavaScript",
            "Bruno-Java",
            "Bruno-Java",
            "Bruno-Java",
            "Bruno-Java",
            "Cricia-BDA2",
            "Cricia-BDA2",
            "Cricia-BDA2",
            "Cricia-BDA2",
            "Edson-MVC",
            "Edson-MVC",
            "Edson-MVC",
            "Edson-MVC",
            "Clarimundo-POO3",
            "Clarimundo-POO3",
            "Clarimundo-POO3",
            "Clarimundo-POO3",
            "Wilton-REACT",
            "Wilton-REACT",
            "Wilton-REACT",
            "Wilton-REACT",
            "Bruno-Teste Unitatio",
            "Bruno-Teste Unitatio",
            "Bruno-Teste Unitatio",
            "Bruno-Teste Unitatio",
            "Cricia-BDA3",
            "Cricia-BDA3",
            "Cricia-BDA3",
            "Cricia-BDA3",
            "Nelio-Monolitico",
            "Nelio-Monolitico",
            "Nelio-Monolitico",
            "Nelio-Monolitico",
            "Edson-React-native",
            "Edson-React-native",
            "Edson-React-native",
            "Edson-React-native",
            "Wilton-IHC",
            "Wilton-IHC",
            "Wilton-IHC",
            "Wilton-IHC",
            "Carlos-Empreendedorismo",
            "Carlos-Empreendedorismo",
            "Carlos-Empreendedorismo",
            "Carlos-Empreendedorismo",
            "Camilo-MicroServicos",
            "Camilo-MicroServicos",
            "Camilo-MicroServicos",
            "Camilo-MicroServicos",
            "Camilo-NoSql",
            "Camilo-NoSql",
            "Camilo-NoSql",
            "Camilo-NoSql",
            "Clarimundo-IC",
            "Clarimundo-IC",
            "Clarimundo-IC",
            "Clarimundo-IC",
            "Sabrina-Libras",
            "Sabrina-Libras",
            "Sabrina-Libras",
            "Sabrina-Libras",
            "Magno-Prelamo",
            "Magno-Prelamo",
            "Magno-Prelamo",
            "Magno-Prelamo",
            "Edson-opcional 1",
            "Edson-opcional 1",
            "Edson-opcional 1",
            "Edson-opcional 1",
            "Camilo-Segurança da Internet",
            "Camilo-Segurança da Internet",
            "Camilo-Segurança da Internet",
            "Camilo-Segurança da Internet",
        ];
        let cont = []
        let arrayNota = []
        //retorna o array ambaralhado
        function shuffleArray(array) {
            const shuffledArray = [...array];
            for (let i = shuffledArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledArray[i], shuffledArray[j]] = [
                    shuffledArray[j],
                    shuffledArray[i],
                ];
            }
            return shuffledArray;
        }
        function getUniqueGroups(array, groupSize, pop) {
            for (let a = 0; a < pop; a++) {
                const periodos = [];
                for (let i = 0; i < prof_disc.length; i += 20) {
                    const periodo = prof_disc.slice(i, i + 20);
                    periodos.push(periodo);
                }
                let cont = 0;
                const shuffledArray = [];
                while (cont < 5) {
                    const shuffledPeriod = shuffleArray(periodos[cont]);
                    shuffledArray.push(...shuffledPeriod);
                    cont++;
                }
                const groups = [];

                while (shuffledArray.length > 0) {
                    const group = shuffledArray.splice(0, groupSize);
                    groups.push(group);
                }
                validation(groups)
                const newAllPeriods = []; // Declarar a variável newAllPeriods fora da função getUniqueGroups
            }
        }


        const allCombinations = []
        const arrayConflitos = []





        function validation(group) {
            let contadorValidateFail = 0

            let primeiro_periodo = [];
            let segundo_periodo = [];
            let terceiro_periodo = [];
            let quarto_periodo = [];
            let quinto_periodo = [];


            //separando o array em 5 divididos por periodo
            for (let i = 0; i < 25; i++) {
                if (i < 5) {
                    primeiro_periodo.push(group[i]);
                } else if (i >= 5 && i <= 9) {
                    segundo_periodo.push(group[i]);
                } else if (i >= 10 && i <= 14) {
                    terceiro_periodo.push(group[i]);
                } else if (i >= 15 && i <= 19) {
                    quarto_periodo.push(group[i]);
                } else {
                    quinto_periodo.push(group[i]);
                }
            }

            //separa os nomes dos professores das materias ministradas
            let nameProf1 = [];
            for (let i = 0; i < primeiro_periodo.length; i++) {
                for (let j = 0; j < primeiro_periodo[i].length; j++) {
                    const value = primeiro_periodo[i][j].split('-')[0];
                    nameProf1.push(value)
                    //console.log(value);
                }
            }

            let nameProf2 = [];
            for (let i = 0; i < segundo_periodo.length; i++) {
                for (let j = 0; j < segundo_periodo[i].length; j++) {
                    const value = segundo_periodo[i][j].split('-')[0];
                    nameProf2.push(value)
                    //console.log(value);
                }
            }

            let nameProf3 = [];
            for (let i = 0; i < terceiro_periodo.length; i++) {
                for (let j = 0; j < terceiro_periodo[i].length; j++) {
                    const value = terceiro_periodo[i][j].split('-')[0];
                    nameProf3.push(value)
                    //console.log(value);
                }
            }

            let nameProf4 = [];
            for (let i = 0; i < quarto_periodo.length; i++) {
                for (let j = 0; j < quarto_periodo[i].length; j++) {
                    const value = quarto_periodo[i][j].split('-')[0];
                    nameProf4.push(value)
                    //console.log(value);
                }
            }

            let nameProf5 = [];
            for (let i = 0; i < quinto_periodo.length; i++) {
                for (let j = 0; j < quinto_periodo[i].length; j++) {
                    const value = quinto_periodo[i][j].split('-')[0];
                    nameProf5.push(value)
                    //console.log(value);
                }
            }


            var conflito1 = 0;
            var conflito2 = 0;
            var conflito3 = 0;
            var conflito4 = 0;

            var conflitoTotal = 0;
            let nameCop

            //validação primeiro com todos 
            for (var i = 0; i < 20; i++) {
                var elemento = nameProf1[i];
                var conflitoEncontrado = false;

                // Loop pelos outros arrays
                for (var j = 2; j <= 5; j++) {
                    var outroArray = eval("nameProf" + j);

                    if (elemento === outroArray[i]) {
                        conflitoEncontrado = true;
                        break;
                    }
                }

                if (conflitoEncontrado) {
                    conflito1++;
                }
            }
            //validação segundo com 3,4,5
            for (var i = 0; i < 20; i++) {
                var elemento = nameProf2[i];
                var conflitoEncontrado = false;

                // Loop pelos outros arrays
                for (var j = 3; j <= 5; j++) {
                    var outroArray = eval("nameProf" + j);

                    if (elemento === outroArray[i]) {
                        conflitoEncontrado = true;
                        break;
                    }
                }

                if (conflitoEncontrado) {
                    conflito2++;
                }
            }
            //validação terceiro com 4,5
            for (var i = 0; i < 20; i++) {
                var elemento = nameProf3[i];
                var conflitoEncontrado = false;

                // Loop pelos outros arrays
                for (var j = 4; j <= 5; j++) {
                    var outroArray = eval("nameProf" + j);

                    if (elemento === outroArray[i]) {
                        conflitoEncontrado = true;
                        break;
                    }
                }

                if (conflitoEncontrado) {
                    conflito3++;
                }
            }

            //validação quarto com 5
            for (var i = 0; i < 20; i++) {
                if (nameProf4[i] == nameProf5[i]) {
                    conflito4++
                }

            }

            //são N individuos
            //arrayConflitos para poder ordenar do menor para maior
            conflitoTotal = conflito1 + conflito2 + conflito3 + conflito4
            arrayConflitos.push(conflitoTotal)

            //todos os arrays com nome e materia do professor
            const allPeriods = primeiro_periodo.concat(segundo_periodo, terceiro_periodo, quarto_periodo, quinto_periodo);
            //allPeriods.push(conflitoTotal)



            //aqui é um array de array. Um array que contem todos os arrays(individuos)
            allCombinations.push(allPeriods) //


            ordination(arrayConflitos, allCombinations)

            newAllPeriods = allCombinations[1];
        }

        //Ordena as combinações de períodos com base na quantidade total de conflitos.
        function ordination(arrayConflitos, allCombinations) {
            return arrayConflitos.map((valor, indice) => ({ valor, indice }))
                .sort((a, b) => a.valor - b.valor)
                .map(elemento => allCombinations[elemento.indice]);

        }

        //gerar eleatorio para cruzamento
        function aleatorio(num1, num2) {
            var primeiraMetade = Math.floor(Math.random() * 5); // Número aleatório de 0 a 4
            var todoArray = Math.floor(Math.random() * 10); // Número aleatório de 0 a 9

            return [primeiraMetade, todoArray];

        }










        const groups = getUniqueGroups(prof_disc, 4, 10);

        children = []
        const arraysOrdenados = ordination(arrayConflitos, allCombinations);
        console.log(arraysOrdenados, "arraysOrdenados")

        function cruzamento(arraysOrdenados, newAllPeriods) {
            // sort cruzamento de individuos
            let [pai, mae] = aleatorio();
            console.log(pai, "sort 1")
            console.log(mae, "sort 2")

            //resultado dos cruzamento de acordo com sort
            let aux1, aux2;
            aux1 = arraysOrdenados[pai].slice(0, 10).concat(arraysOrdenados[mae].slice(10, 25));
            aux2 = arraysOrdenados[mae].slice(0, 10).concat(arraysOrdenados[pai].slice(10, 25));

            console.log(aux1, "efetuado o cruzamento")
            console.log(newAllPeriods, "array que vou tirar fragmento para mutação")

        }




        function realizarMutacao(array) {
            // gerar número aleatório para indivíduo e horário
            const random_ind = Math.floor(Math.random() * 25); // indivíduo
            const random_horario = Math.floor(Math.random() * 4); // horário

            // somente para aux
            const auxRandom = Math.floor(Math.random() * 25); // indivíduo

            const stringAux = newAllPeriods[random_ind][random_horario];
            console.log(stringAux);

            // mutação
            array[auxRandom][random_horario] = stringAux;
            console.log(array, "new");
        }
        children.push(aux1, aux2);

        //aqui tenho que fazer voltar para gerar mais filhos

        // Chamada da função cruzamento com os parâmetros adequados
        const resultadoCruzamento = cruzamento(arraysOrdenados, newAllPeriods);

        console.log(children, "chil")








    </script>
</head>

<body>
    <button onclick="getUniqueGroups(prof_disc, 4)">Teste</button>
</body>

</html>
